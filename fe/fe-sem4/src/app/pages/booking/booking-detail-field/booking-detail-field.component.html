<div class="main-containers">
  <h1 class="detail-title">
    ThÃ´ng tin chi tiáº¿t sÃ¢n bÃ³ng
  </h1>
  <div class="stadium-container">
    <!-- áº¢nh sÃ¢n váº­n Ä‘á»™ng -->
    <div class="stadium-image">
      <img [src]="img" alt="Stadium Image" />
    </div>
    <div class="stadium-infor">
      <h1>{{ stadiumDetail.name }}</h1>
      <p class="address">
        <strong>ğŸ“ Äá»‹a chá»‰:</strong> {{ stadiumDetail.address }}
      </p>
      <p class="description">
        <strong>â„¹ï¸ MÃ´ táº£:</strong> {{ stadiumDetail.description }}
      </p>
      <p><strong>ğŸ“§ Email:</strong> {{ stadiumDetail.email }}</p>
      <p><strong>ğŸ“ Sá»‘ Ä‘iá»‡n thoáº¡i:</strong> {{ stadiumDetail.phoneNumber }}</p>
      <div class="booking-options">
        <label class="radio-check">
          <input
            type="radio"
            name="bookingType"
            value="single"
            [(ngModel)]="bookingType"
          />
          Äáº·t sÃ¢n láº»
        </label>
        <label class="radio-check">
          <input
            type="radio"
            name="bookingType"
            value="longTerm"
            [(ngModel)]="bookingType"
          />
          Äáº·t dÃ i háº¡n
        </label>
        <label class="radio-check">
          <input
            type="radio"
            name="bookingType"
            value="tournament"
            [(ngModel)]="bookingType"
          />
          Äáº·t giáº£i Ä‘áº¥u
        </label>
      </div>
      <div>
        <button class="buttonBook" (click)="openDate()">Äáº·t sÃ¢n ngay</button>
      </div>
    </div>
  </div>
  <div class="main-container" *ngIf="isPopup">
    <div class="main-container" *ngIf="scheduleData">
      <div style="display: flex; justify-content: space-between">
        <h2>Äáº·t lá»‹ch sÃ¢n Ä‘áº¥u</h2>
        <h3>
          Tá»« {{ scheduleData.calender[0] | date : "dd/MM/yyyy" }} Ä‘áº¿n
          {{ scheduleData.calender[1] | date : "dd/MM/yyyy" }}
        </h3>
      </div>

      <table>
        <thead>
          <tr>
            <th>Khung giá»</th>
            <th *ngFor="let frame of scheduleData.timeFrames">
              {{ frame.dateString }}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let tf of getAllTimeFrames()">
            <td>{{ timeFramesMap[tf] }}</td>
            <td *ngFor="let frame of scheduleData.timeFrames">
              <ng-container
                *ngIf="getScheduleForTimeFrame(frame, tf) as schedule"
              >
                <div
                  class="choose-field"
                  [ngClass]="{
                selected: isSelected(schedule, frame.date),
              }"
                  (click)="choose(schedule, frame.date)"
                >
                  {{ schedule.price }} (cÃ²n {{ schedule.quantity }} sÃ¢n)
                </div>
              </ng-container>
              <ng-container *ngIf="!getScheduleForTimeFrame(frame, tf)">
                <span>KhÃ´ng cÃ³ dá»¯ liá»‡u</span>
              </ng-container>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="selected-fields-container" *ngIf="selectedFields.length > 0">
        <h3>Danh sÃ¡ch sÃ¢n Ä‘Ã£ chá»n:</h3>
        <table class="selected-fields-table">
          <thead>
            <tr>
              <th>Thá»i gian</th>
              <th>Sá»‘ lÆ°á»£ng</th>
              <th>GiÃ¡</th>
              <th>NgÃ y</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let field of selectedFields">
              <td>{{ field.timeFrameStr }}</td>
              <!-- <td>{{ field.quantity }}</td> -->
              <td>
                <input
                  type="number"
                  [(ngModel)]="field.quantity"
                  [min]="1"
                  [max]="field.availableQuantity"
                  (ngModelChange)="onQuantityChange(field)"
                  class="form-control"
                />
              </td>
              <td>{{ field.amount }}</td>
              <td>{{ field.date }}</td>
            </tr>
          </tbody>
        </table>
        <button
          class="payment-btn mt-5"
          (click)="goToPayment()"
          [disabled]="selectedFields.length === 0"
        >
          Äi Ä‘áº¿n thanh toÃ¡n
        </button>
      </div>
    </div>
  </div>

  <!-- Stadium cards with pagination -->
  <h1 class="section-title mt-5">CÃ¡c sÃ¢n bÃ³ng gáº§n Ä‘Ã¢y</h1>

  <div class="stadium-list">
    <div *ngFor="let stadium of paginatedStadiums" class="stadium-card">
      <img [src]="img" alt="ok" />
      <div class="stadium-info">
        <h3>{{ stadium.name }}</h3>
        <p>{{ stadium.address }}</p>
        <!--        <div class="rating">-->
        <!--          <span *ngFor="let star of [].constructor(stadium.rating)">{{ 'â˜…â˜…â˜…â˜…' }}</span>-->
        <!--        </div>-->
        <div class="rating">
          <ng-container *ngFor="let i of [1, 2, 3, 4, 5]">
            <span class="star" *ngIf="i <= stadium.rating">â˜…</span>
            <span class="empty-star" *ngIf="i > stadium.rating">â˜…</span>
          </ng-container>
        </div>
      </div>
      <div class="action-buttons">
        <button class="btn-map" (click)="openMapWithCoordinates(stadium.latitude, stadium.longitude)">
          <i class="fas fa-eye"></i> Xem báº£n Ä‘á»“
        </button>
        <button class="btn-detail" (click)="viewDetail(stadium.areaId)">
          <i class="fas fa-info-circle"></i> Xem chi tiáº¿t
        </button>
      </div>
    </div>
  </div>

  <!-- Pagination controls -->
  <div class="pagination-controls" *ngIf="dataStadium.length > itemsPerPage">
    <button
      [disabled]="currentPage === 1"
      (click)="changePage(currentPage - 1)"
      class="pagination-btn"
    >
      &laquo; Previous
    </button>
    <span class="page-indicator">Page {{ currentPage }} of {{ totalPages }}</span>
    <button
      [disabled]="currentPage === totalPages"
      (click)="changePage(currentPage + 1)"
      class="pagination-btn"
    >
      Next &raquo;
    </button>
  </div>

  <p></p>
</div>
<div class="popup-overlay" *ngIf="showLongTermPopup" (click)="closePopup()">
  <div class="popup" (click)="$event.stopPropagation()">
    <button class="close-button" (click)="closePopup()">&times;</button>
    <h2>Äáº·t sÃ¢n dÃ i háº¡n</h2>

    <label
    >TÃªn ngÆ°á»i Ä‘áº·t sÃ¢n:
      <input type="text" class="input-label-popup" [(ngModel)]="longTerm.name" />
    </label>

    <label
    >Sá»‘ Ä‘iá»‡n thoáº¡i:
      <input type="tel" class="input-label-popup" [(ngModel)]="longTerm.phone" />
    </label>

    <label
    >NgÃ y báº¯t Ä‘áº§u:
      <input type="date" class="input-label-popup" [(ngModel)]="longTerm.startDate" />
    </label>

    <label
    >NgÃ y káº¿t thÃºc:
      <input type="date" class="input-label-popup" [(ngModel)]="longTerm.endDate" />
    </label>

    <label
    >Khung giá» Ä‘Ã¡:
      <select [(ngModel)]="longTerm.timeSlot">
        <option *ngFor="let time of timeSlots" [value]="time">
          {{ time }}
        </option>
      </select>
    </label>

    <label>NgÃ y Ä‘Ã¡ trong tuáº§n:</label>
    <div class="checkbox-group">
      <div class="weekday-row top-row" style="justify-content: center" >
        <label class="day-item ">
          <input type="checkbox" [(ngModel)]="longTerm.days['Thá»© 2']" />
          <span>Mon</span>
        </label>
        <label class="day-item ">
          <input type="checkbox" [(ngModel)]="longTerm.days['Thá»© 3']" />
          <span>Tue</span>
        </label>
        <label class="day-item ">
          <input type="checkbox" [(ngModel)]="longTerm.days['Thá»© 4']" />
          <span>Wed</span>
        </label>
      </div>
      <div class="weekday-row bottom-row" style="justify-content: center">
        <label class="day-item">
          <input type="checkbox" [(ngModel)]="longTerm.days['Thá»© 5']" />
          <span>Thu</span>
        </label>
        <label class="day-item">
          <input type="checkbox" [(ngModel)]="longTerm.days['Thá»© 6']" />
          <span>Fri</span>
        </label>
        <label class="day-item">
          <input type="checkbox" [(ngModel)]="longTerm.days['Thá»© 7']" />
          <span>Sat</span>
        </label>
        <label class="day-item">
          <input type="checkbox" [(ngModel)]="longTerm.days['Chá»§ Nháº­t']" />
          <span>Sun</span>
        </label>
      </div>
    </div>
    <div class="terms-container">
      <p>
        Xem cÃ¡c Ä‘iá»u khoáº£n cá»§a sÃ¢n:
        <a href="#" (click)="showLongTermPopup = true">Táº¡i Ä‘Ã¢y</a>
      </p>
    </div>

    <div class="button-group">
      <button class="submit" (click)="confirmLongTerm()">XÃ¡c nháº­n</button>
      <button class="cancel" (click)="closePopupLong()">ÄÃ³ng</button>
    </div>
  </div>
</div>

<!--<div *ngIf="showLongTermPopup" class="popup-overlay" data-aos="fade-up">-->
<!--  <div class="popup">-->
<!--    -->
<!--  </div>-->
<!--</div>-->

<!-- Popup Ä‘áº·t giáº£i Ä‘áº¥u -->
<div *ngIf="showTournamentPopup" class="popup-overlay" data-aos="fade-up">
  <div class="popup">
    <h2>Äáº·t giáº£i Ä‘áº¥u</h2>
    <button class="close-button" (click)="closePopup()">&times;</button>

    <label class="input-label-popup">
      TÃªn giáº£i Ä‘áº¥u:
      <input type="text" [(ngModel)]="tournament.name" class="form-control" />
    </label>

    <label class="input-label-popup">
      Sá»‘ Ä‘á»™i tham gia:
      <input type="number" [(ngModel)]="tournament.teams" class="form-control" />
    </label>

    <label class="input-label-popup">
      Sá»‘ tráº­n Ä‘áº¥u dá»± kiáº¿n:
      <input type="number" [(ngModel)]="tournament.matches" class="form-control" />
    </label>

    <label class="input-label-popup">
      NgÃ y báº¯t Ä‘áº§u:
      <input type="date" [(ngModel)]="tournament.startDate" class="form-control" />
    </label>

    <label class="input-label-popup">
      NgÃ y káº¿t thÃºc:
      <input type="date" [(ngModel)]="tournament.endDate" class="form-control" />
    </label>

    <label class="input-label-popup">
      TÃªn ngÆ°á»i Ä‘Äƒng kÃ½:
      <input type="text" [(ngModel)]="tournament.registrantName" class="form-control" />
    </label>

    <label class="input-label-popup">
      Email:
      <input type="email" [(ngModel)]="tournament.email" class="form-control" />
    </label>

    <label class="input-label-popup">
      Sá»‘ Ä‘iá»‡n thoáº¡i liÃªn há»‡:
      <input type="tel" [(ngModel)]="tournament.phone" class="form-control" />
    </label>

    <div class="terms-container">
      <p>
        Xem cÃ¡c Ä‘iá»u khoáº£n cá»§a sÃ¢n:
        <a href="#" (click)="showLongTermPopup = true; $event.preventDefault()">Táº¡i Ä‘Ã¢y</a>
      </p>
    </div>

    <div class="button-group">
      <button class="submit" (click)="confirmTournament()">XÃ¡c nháº­n</button>
      <button class="cancel" (click)="closePopup()">ÄÃ³ng</button>
    </div>
  </div>
</div>
